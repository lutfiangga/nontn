---
import type { MediaItem } from "@type/api";
import { formatRating, extractDetailPath } from "@lib/utils/helpers";

interface Props {
  item: MediaItem;
}

const { item } = Astro.props;
---

<a
  href={item.detailPath ? `/detail/${extractDetailPath(item.detailPath)}` : "#"}
  class="group block relative aspect-[2/3] overflow-hidden bg-zinc-900 border-2 border-black shadow-[4px_4px_0px_0px_black] hover:translate-x-1 hover:translate-y-1 hover:shadow-none transition-all duration-200"
  data-aos="fade-up"
>
  <div class="absolute inset-0">
    <img
      src={item.poster ||
        "https://placehold.co/400x600/18181b/52525b?text=No+Poster"}
      alt={item.title}
      class="w-full h-full object-cover transition-transform duration-500"
      loading="lazy"
    />
    <div
      class="absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent opacity-80 group-hover:opacity-60 transition-opacity"
    >
    </div>
  </div>

  {
    item.rating && (
      <div class="absolute top-2 left-2 z-10">
        <div class="bg-yellow-400 text-black text-xs font-black px-2 py-1 border-2 border-black -rotate-3 group-hover:rotate-0 transition-transform flex items-center gap-1">
          <span>★</span>
          {formatRating(item.rating)}
        </div>
      </div>
    )
  }

  <div
    class="absolute bottom-0 left-0 right-0 p-4 transform translate-y-2 group-hover:translate-y-0 transition-transform duration-300"
  >
    <h3
      class="text-white font-black text-lg uppercase leading-none mb-1 line-clamp-2 italic drop-shadow-[2px_2px_0_#000]"
    >
      {item.title}
    </h3>
    <div
      class="flex flex-wrap gap-2 text-[10px] font-bold uppercase tracking-widest text-zinc-400"
    >
      <span>{item.year || "N/A"}</span>
      {
        item.type && (
          <>
            <span>•</span>
            <span>{item.type}</span>
          </>
        )
      }
    </div>
  </div>
</a>
